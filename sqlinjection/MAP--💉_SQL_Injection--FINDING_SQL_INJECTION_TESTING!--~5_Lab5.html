<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>#5 Lab5</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>#5 Lab5</h1><br/><strong><h3>Lab: SQL injection UNION attack, retrieving data from other tables</h3></strong><br /><br /><a href=""><img src="images/17-1.png" alt="images/17-1.png" /></a><br /><br />according to the lab we need to extract username and password from the users table and then login as administrator user whose creds we would hopefully find from the Injection.<br /><br /><br /><br />as we would do we start by enumerating the total numbers of columns using the order by method and we can also use the script we wrote earlier<br /><br />manually we Found Two columns using ORDER BY method<br /><a href=""><img src="images/17-2.png" alt="images/17-2.png" /></a><br /><br />and now we will use our script determine the columns<br /><a href=""><img src="images/17-3.png" alt="images/17-3.png" /></a><br /><br />and our script also Finds the same number of columns...the source code of script is present at:‚Üí <a href="MAP--üíâ_SQL_Injection--FINDING_SQL_INJECTION_TESTING!--~3_Lab3--SCRIPT.html">SCRIPT</a><br /><br />now we get Furthur onto Determining what Gets Printed<br /><br />as usual we will start with manual method and we find the very First column that gets printed<br /><a href=""><img src="images/17-4.png" alt="images/17-4.png" /></a><br /><br />and now we need to Dump data but before we do so we will use our script to determine Column which gets printed again but this time using script which can be found at <a href="MAP--üíâ_SQL_Injection--FINDING_SQL_INJECTION_TESTING!--~4_Lab4--SCRIPT.html">SCRIPT</a><br /><br /><a href=""><img src="images/17-5.png" alt="images/17-5.png" /></a><br /><br />and this time the application tells us that both payloads are successfull and this so because this particular application {which is a lab} prints the Query which we executed causing our condition for searching the input value in responce to be true on both tries but this won&#39;t happen in real world since we will not have Queries executed printed on screen here its Just done for may <br />be more clarity that what we just executed...and confirm etc..<br /><br />But from our both manual and scripted efforts we know that First column gets printed we will now extract data mnually<br />here we know that the columns and tables present etc....<br /><br /><br /><strong><code><span style="background-color:#ff0000;">Payload1 For users:</span></code></strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;username,&nbsp;NULL&nbsp;from&nbsp;users&nbsp;--</span><br /></div></div><br /><a href=""><img src="images/17-6.png" alt="images/17-6.png" /></a><br /><br />and we Find three users<br /><br /><br /><strong><code><span style="background-color:#ff0000;">Payload2 For passwords:</span></code></strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;password,&nbsp;NULL&nbsp;from&nbsp;users&nbsp;--</span><br /></div></div><br /><br /><a href=""><img src="images/17-7.png" alt="images/17-7.png" /></a><br /><br />and we are able to dump the creds for users <br />But we are particulary intersted in the <span style="color:#ff0000;">administrator</span> user<br /><br />now as said by Lab we will try logging in using these creds we Discovered.<br />But before we do so we can make our search more specific by adding a where clause to looks for creds of admin user..<br /><br /><strong><code><span style="background-color:#ff0000;">Payload3 For administrator:</span></code></strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;password,&nbsp;NULL&nbsp;FROM&nbsp;users&nbsp;WHERE&nbsp;username&nbsp;=&nbsp;&#39;</span>administrator<span style="color:#3ad900;font-weight:400">&#39;&nbsp;&nbsp;--</span><br /></div></div><br /><br /><a href=""><img src="images/17-8.png" alt="images/17-8.png" /></a><br /><br />so now we have creds for the admin user and they are<br /><br />username: <code><span style="color:#ff0000;">administrator</span></code><br />password: <span style="color:#00ff00;">kx4wn0tefn49orgjsway</span><br /><br />now we will login to web app as admin user as suggested by application<br /><a href=""><img src="images/17-9.png" alt="images/17-9.png" /></a><br /><br />and we are in as admin user..... üòÅÔ∏è<br /><br />yeah script.....? well we will right one that would extract everything in one go from determining columns tables etc...making one for specifically tables , columns present here would be unreliable......!<br /></div></body></html>