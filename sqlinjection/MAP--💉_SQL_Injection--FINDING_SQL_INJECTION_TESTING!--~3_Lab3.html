<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>#3 Lab3</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>#3 Lab3</h1><br/><strong><h3>Lab: SQL injection UNION attack, determining the number of columns returned by the query</h3></strong><br /><br /><a name="SQL_INJECTION_ENUMERATING_COLUMNS_WITH_ORDER_BY_METHOD{MSSQL-and-MYSQL_ORACLE}"></a><br /><br /><br /><a href=""><img src="images/13-1.png" alt="images/13-1.png" /></a><br /><br />In this lab we will see how we can determine the number of columns returned by the Query<br /><br />now we will access the lab<br /><a href=""><img src="images/13-2.png" alt="images/13-2.png" /></a><br /><br />we have the category param which is vuln..<br /><br />and now we will use the order by method to First determine the number of columns<br /><br /><strong><span style="background-color:#ff0000;">Initial Payload</span></strong>:<br /><br /><div class="codebox"><div class="codebox">Gifts<span style="color:#3ad900;font-weight:400">&#39;&nbsp;ORDER&nbsp;BY&nbsp;1&nbsp;--</span><br /></div></div><br /><a href=""><img src="images/13-3.png" alt="images/13-3.png" /></a><br /><br />and everything seems to work correct, but now we increase the order number one by one to a extent when we get error<br /><br /><br />we reach<br /><div class="codebox"><div class="codebox">Gifts<span style="color:#3ad900;font-weight:400">&#39;&nbsp;ORDER&nbsp;BY&nbsp;3&nbsp;--</span><br /></div></div><br /><br />but as soon as we increase the number to 4 we get an error , which means that we have 3 columns...<br /><a href=""><img src="images/13-4.png" alt="images/13-4.png" /></a><br /><br />so now we can safely conclude that we have 3 columns in there, now we need to start dumping data but before we need to see what gets printed to screen from our 3 columns that we will probe using the UNION method<br /> <br /> <br /> <br /><strong><span style="background-color:#ff0000;">Payload1:→ </span></strong><br /> <br /> <div class="codebox"><div class="codebox">Gifts<span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;&#39;</span><span style="color:#ff0044;font-weight:400">111</span><span style="color:#3ad900;font-weight:400">&#39;,&nbsp;NULL,&nbsp;NULL&nbsp;--</span><br /></div></div><br /> <a href=""><img src="images/13-5.png" alt="images/13-5.png" /></a><br /> <br /> we don&#39;t see 111 printed to screen which means that the First columns does not get printed to screen so we would now Try with the second column<br /> <br /><strong><span style="background-color:#ff0000;">Payload2:→ </span></strong><br /><br /><div class="codebox"><div class="codebox">Gifts<span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;NULL,&nbsp;&#39;</span><span style="color:#ff0044;font-weight:400">111</span><span style="color:#3ad900;font-weight:400">&#39;,&nbsp;NULL&nbsp;--</span><br /></div></div><br /><br /><a href=""><img src="images/13-6.png" alt="images/13-6.png" /></a><br /><br />and we can see that the 111 gets printed to the screen , now that we know whats getting printed to the screen we will move ahead into dumping some data<br /><br /><br /><strong><span style="background-color:#ff0000;">Important Note:</span></strong><br /><br /><strong><span style="background-color:#7f7f7f;">• The reason for using </span></strong><strong><code><span style="background-color:#7f7f7f;">NULL</span></code></strong><strong><span style="background-color:#7f7f7f;"> as the values returned from the injected </span></strong><strong><code><span style="background-color:#7f7f7f;">SELECT</span></code></strong><strong><span style="background-color:#7f7f7f;"> query is that the data types in each column must be compatible between the original and the injected queries. Since </span></strong><strong><code><span style="background-color:#7f7f7f;">NULL</span></code></strong><strong><span style="background-color:#7f7f7f;"> is convertible to every commonly used data type, using </span></strong><strong><code><span style="background-color:#7f7f7f;">NULL</span></code></strong><strong><span style="background-color:#7f7f7f;"> maximizes the chance that the payload will succeed when the column count is correct.                <br /><br />• On Oracle, every </span></strong><strong><code><span style="background-color:#7f7f7f;">SELECT</span></code></strong><strong><span style="background-color:#7f7f7f;"> query must use the </span></strong><strong><code><span style="background-color:#7f7f7f;">FROM</span></code></strong><strong><span style="background-color:#7f7f7f;"> keyword and specify a valid table. There is a built-in table on Oracle called </span></strong><strong><code><span style="background-color:#7f7f7f;">dual</span></code></strong><strong><span style="background-color:#7f7f7f;"> which can be used for this purpose. So the injected queries on Oracle would need to look like: </span></strong><strong><code><span style="background-color:#7f7f7f;">&#39; UNION SELECT NULL FROM DUAL--</span></code></strong><strong><span style="background-color:#7f7f7f;">.                <br /><br />• The payloads described use the double-dash comment sequence </span></strong><strong><code><span style="background-color:#7f7f7f;">--</span></code></strong><strong><span style="background-color:#7f7f7f;"> to comment out the remainder of the original query following the injection point. On MySQL, the double-dash sequence must be followed by a space. Alternatively, the hash character </span></strong><strong><code><span style="background-color:#7f7f7f;">#</span></code></strong><strong><span style="background-color:#7f7f7f;"> can be used to identify a comment.  </span></strong>              <br />            <br /></div></body></html>