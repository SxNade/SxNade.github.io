<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>#9 Lab9</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>#9 Lab9</h1><br/><strong><h3>Lab: SQL injection attack, listing the database contents on non-Oracle databases</h3></strong><br /><br /><a name="SQL_INJECTION_ENUMERATING_DB-STRUCTURE_{MSSQL-and-MYSQL}"></a><br /><br /><a href=""><img src="images/21-1.png" alt="images/21-1.png" /></a><br /><br /><br />As the lab initially states we can use the UNION injection method to dump data but here we also need to extract what tables and columns are present in the database and then precisely dump creds of users...<br /><br />as usual we need to start by Determinig the totoal number of columns using ORDER By method<br /><a href=""><img src="images/21-2.png" alt="images/21-2.png" /></a><br /><br />our script has determined that we have 2 columns and now we have to manually determine what gets printed<br /><br /><br /><a href=""><img src="images/21-3.png" alt="images/21-3.png" /></a><br /><br />and we modify the Query a bit<br /><a href=""><img src="images/21-4.png" alt="images/21-4.png" /></a><br /><br />we can see that both the columns of string type get printed....and now we can Enumerate the database structure<br /><br /><br /><br /><strong><h3># Listing Tables</h3></strong><br /><br />Now we will move into Finding the tables present with following payload<br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;table_name,&nbsp;NULL&nbsp;FROM&nbsp;information_schema.tables&nbsp;--</span><br /></div></div><br /><br />this will list all the tables present in the database..<br /><a href=""><img src="images/21-5.png" alt="images/21-5.png" /></a><br /><br />out of all tables the users_zoqwbc looks intersting...<br /><br />now we need to extract all the columns present in this table using the following payload<br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;column_name,&nbsp;NULL&nbsp;FROM&nbsp;information_schema.columns&nbsp;WHERE&nbsp;table_name=&#39;</span>users_prxtgp<span style="color:#3ad900;font-weight:400">&#39;&nbsp;--</span><br /></div></div><br /><br />and now we run our Query...<br /><br /><a href=""><img src="images/21-6.png" alt="images/21-6.png" /></a><br /><br />and we have Found two juicy columns present in the database....and now we extract them all using the following Query..<br />we also concat function to organize info more precisely<br /><br /><br /><a name="SQL_INJECTION_MULTIPLE_VALUES_IN_SINGLE_COLUMN_{MYSQL}"></a><br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;CONCAT(password_qzmbdn,&nbsp;&#39;</span>&nbsp;-&nbsp;<span style="color:#3ad900;font-weight:400">&#39;,&nbsp;username_mugixd)&nbsp;AS&nbsp;CREDS,&nbsp;NULL&nbsp;FROM&nbsp;users_prxtgp&nbsp;--</span><br /></div></div><br /><br />After we run the Query.!<br /><a href=""><img src="images/21-7.png" alt="images/21-7.png" /></a><br /><br />according to the lab decription we need to login with admin creds to complete lab<br /><br />user:<span style="color:#ff0000;">administrator</span><br /><br />password: <span style="color:#00ff00;">7i3olk7r27l108x16v7i</span> <br /><a href=""><img src="images/21-8.png" alt="images/21-8.png" /></a><br /><br />we have completed the lab...</div></body></html>