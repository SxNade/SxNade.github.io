<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>#7 Lab7</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>#7 Lab7</h1><br/><strong><h3>Lab: SQL injection attack, querying the database type and version on Oracle</h3></strong><br /><br /><br /><a name="SQL_INJECTION_UNION-METHOD_DB-VERSION_ORACLEdb"></a><br /><br /><a href=""><img src="images/19-1.png" alt="images/19-1.png" /></a><br /><br /><br />we will access the lab<br /><a href=""><img src="images/19-2.png" alt="images/19-2.png" /></a><br /><br />the lab description already told us that we can use the UNION attack to extract database version<br /><br />now as we would do in an ideal situation we will start by mapping out the number of columns which we can deduce manually with order by method or also use our script.....just for speed we will use the script which Finds teh columns and also tells us what gets printed {the printed can be unreliable and we know why}<br /><br /><a href=""><img src="images/19-3.png" alt="images/19-3.png" /></a><br /><br />so the script atleast told us that we have  columns and now we can use UNION and NULL method to see what gets printed...<br /><br />now we get Error On extrction of column which contains text because ...we have Oracle here and with Oracle we must have a From statement in Query<br /><br /><a name="SQL_INJECTION_FINDING_COLUMN_CONTAINING_TEXT_PRINTED_ORACLEdb"></a><br /><br /><br /><strong><span style="background-color:#7f7f7f;">On Oracle databases, every </span></strong><strong><code><span style="background-color:#7f7f7f;">SELECT</span></code></strong><strong><span style="background-color:#7f7f7f;"> statement must specify a table to select </span></strong><strong><code><span style="background-color:#7f7f7f;">FROM</span></code></strong><strong><span style="background-color:#7f7f7f;">. If your </span></strong><strong><code><span style="background-color:#7f7f7f;">UNION SELECT</span></code></strong><strong><span style="background-color:#7f7f7f;"> attack does not query from a table, you will still need to include the </span></strong><strong><code><span style="background-color:#7f7f7f;">FROM</span></code></strong><strong><span style="background-color:#7f7f7f;"> keyword followed by a valid table name.                 <br />There is a built-in table on Oracle called </span></strong><strong><code><span style="background-color:#7f7f7f;">dual</span></code></strong><strong><span style="background-color:#7f7f7f;"> which you can use for this purpose. For example: </span></strong><strong><code><span style="background-color:#7f7f7f;">UNION SELECT &#39;abc&#39; FROM dual</span></code></strong><strong><span style="background-color:#7f7f7f;">  </span></strong>               <br /><br /><br />more on database specifics is present onâ†’ <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a><br /><br />so our payload would be as follows..<br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;&#39;</span><span style="color:#ff0044;font-weight:400">11</span><span style="color:#3ad900;font-weight:400">&#39;,&nbsp;NULL&nbsp;FROM&nbsp;dual&nbsp;--</span><br /></div></div><br /><br /><br />and Luck our First Shot works prefectly and we then modify our Query a bit <br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;&#39;</span><span style="color:#ff0044;font-weight:400">11</span><span style="color:#3ad900;font-weight:400">&#39;,&nbsp;&#39;</span><span style="color:#ff0044;font-weight:400">22</span><span style="color:#3ad900;font-weight:400">&#39;&nbsp;FROM&nbsp;dual&nbsp;--</span><br /></div></div><br /><br />and this works prompting us that both the columns are string data type..<br /><a href=""><img src="images/19-4.png" alt="images/19-4.png" /></a><br /><br /><br />good so now according to lab we need to find the version, we inspect the cheat sheet and find this<br /><a href=""><img src="images/19-5.png" alt="images/19-5.png" /></a><br /><br />and now we will modify our Query to extract the needed data..<br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;banner,&nbsp;NULL&nbsp;FROM&nbsp;v$version--</span><br /></div></div><br /><a href=""><img src="images/19-6.png" alt="images/19-6.png" /></a><br /><br />now we can also take this Furthur by specifically extracting version using following Query<br /><br /><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">&#39;&nbsp;UNION&nbsp;SELECT&nbsp;version,&nbsp;NULL&nbsp;FROM&nbsp;v$instance--</span><br /></div></div><br /><a href=""><img src="images/19-7.png" alt="images/19-7.png" /></a><br /><br />and this lab is over now<br /></div></body></html>