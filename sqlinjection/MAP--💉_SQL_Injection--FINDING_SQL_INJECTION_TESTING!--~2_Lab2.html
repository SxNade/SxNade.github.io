<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>#2 Lab2</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>#2 Lab2</h1><br/><strong><h3>Lab: SQL injection vulnerability allowing login bypass</h3></strong><br /><br /><a name="BASIC_SQL_INJECTION_ALLOWING_LOGIN_BYPASS"></a><br /><br /><a href=""><img src="images/11-1.png" alt="images/11-1.png" /></a><br /><br /><br />now we will access the lab...<br />So our main goal is to login into the application as the administrator user<br /><a href=""><img src="images/11-2.png" alt="images/11-2.png" /></a><br /><br />and here we have the login form<br /><br /><strong><span style="background-color:#ff0000;"># We will start by Throwing some Commas to see if we get any Errors</span></strong><br /><br />Our First payload starts with:<br /><br />	username: <span style="color:#00ff00;">&#39;</span><br />	password: <span style="color:#00ff00;">anything</span><br /><br />and this shows up a Internal server Error<br /><a href=""><img src="images/11-3.png" alt="images/11-3.png" /></a><br /><br /><br />and the Errors are not so verbose to actually tell us the backend Query so we would have to Figure it out by Fuzzing and Guessing a Query to makr Everything work<br /><br /><br /><strong><span style="background-color:#ff0000;"># Assumption Query</span></strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">SELECT</span>&nbsp;firstname&nbsp;<span style="color:#ff9d00;font-weight:700">FROM</span>&nbsp;users&nbsp;<span style="color:#ff9d00;font-weight:700">where</span>&nbsp;username&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">&#39;input1&#39;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;password=<span style="color:#3ad900;font-weight:400">&#39;input&nbsp;2&nbsp;likely&nbsp;here&nbsp;would&nbsp;be&nbsp;some&nbsp;hashing&nbsp;function&#39;</span><br /></div></div><br /><br /><strong><span style="background-color:#7f7f7f;">â€¢ Assuming that Query Looks something Like this , we can try a simple payload</span></strong><br /><br /><strong><span style="background-color:#ff0000;">Initial Payload:</span></strong>  {<span style="color:#00ff00;">for username</span>}<br /><br /><div class="codebox"><div class="codebox">administrator<span style="color:#3ad900;font-weight:400">&#39;&nbsp;--</span><br /></div></div><br /><br /><strong><span style="background-color:#7f7f7f;">Now if we add this in our Query</span></strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">SELECT</span>&nbsp;firstname&nbsp;<span style="color:#ff9d00;font-weight:700">FROM</span>&nbsp;users&nbsp;<span style="color:#ff9d00;font-weight:700">where</span>&nbsp;username&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">&#39;administrator&#39;</span>&nbsp;<span style="color:#0088ff;font-weight:400">--&#39;&nbsp;and&nbsp;password=&#39;input&nbsp;2&nbsp;likely&nbsp;here&nbsp;would&nbsp;be&nbsp;some&nbsp;hashing&nbsp;function&#39;</span><br /></div></div><br /><br /><br />and we can see that the whole the logic whole query gets altered the password field gets commented out and now we are only selecting the username admin and this will return True thus logging us in as the <code><span style="color:#00ff00;">administrator</span></code> user<br /><br />so Now we will Try this payload in our Query<br /><br />when we try this payload we get logged in as the admin user<br /><a href=""><img src="images/11-4.png" alt="images/11-4.png" /></a><br /></div></body></html>