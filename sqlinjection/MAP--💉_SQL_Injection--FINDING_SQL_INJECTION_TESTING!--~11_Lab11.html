<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>#11 Lab11</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>#11 Lab11</h1><br/><strong><h3>Lab: Blind SQL injection with conditional responses</h3></strong><br /><br />-x-x-x-x Not completed yet [will add asap] -x-x-x-x-x<br /><br /><br /><br /><br /><a href=""><img src="images/25-1.png" alt="images/25-1.png" /></a><br /><br />The lab already explains us that the vuln exists in the Tracking cookie param...so now we will lanuch the lab and then get a request intercepted in burp...<br /><br /><strong><h3>• First we will Try to check if the Param is vulnerable or not</h3></strong><br /><br /><br />now know from the lab decription that if the tracking id is right we get a Welcome Back in the response from the target so we can assume that Query for checking Tracking id is a typical select statement that selects tracking id from a table to match it with a where clause...<br /><br /><br /><strong><span style="background-color:#7f7f7f;">• testing</span></strong><br /><br />now will test the theory by adding following payload to the cookie value<br /><br /><div class="codebox"><div class="codebox">&lt;cookie-already-here&gt;&nbsp;<span style="color:#3ad900;font-weight:400">&#39;&nbsp;AND&nbsp;1=1&nbsp;--</span><br /></div></div><br /><br />so here we add &#39; Quote to complete the tracking id variable value and then add another add statement of 1=1 and then -- to comment rest of the Query...<br /><br />now since 1=1 will return True and we already have a right tracking-id overall the statement should return True in other words we should get a Welcome Back in response<br /><a href=""><img src="images/25-2.png" alt="images/25-2.png" /></a><br /><br />It works!<br /><br />now we need to Furthur modify our payload a bit<br /><br /><div class="codebox"><div class="codebox">&lt;cookie-already-here&gt;&nbsp;<span style="color:#3ad900;font-weight:400">&#39;&nbsp;AND&nbsp;1=2&nbsp;--</span><br /></div></div><br /><br />This time we are trying to make the Query return False overall which should then not send Welcome Back in response and if so then we have a Injection.<br /><a href=""><img src="images/25-3.png" alt="images/25-3.png" /></a><br /><br />we don&#39;t see a welcome message back which means that we have a successfull injection<br /><br /><br /><strong><span style="background-color:#7f7f7f;">• Checking if Users table exists or not</span></strong><br /><br /><br />since we are solely relying on True and False logic our next payload to check if users table exists or not will look like this..<br /><br /><div class="codebox"><div class="codebox">&lt;cookie-already-here&gt;&nbsp;<span style="color:#3ad900;font-weight:400">&#39;&nbsp;AND&nbsp;(SELECT&nbsp;&#39;</span>x<span style="color:#3ad900;font-weight:400">&#39;&nbsp;FROM&nbsp;users&nbsp;LIMIT&nbsp;1)=&#39;</span>x<span style="color:#3ad900;font-weight:400">&#39;&nbsp;--</span><br /></div></div><br /><br />now in This Query we select x from users table and then check if it is Equal to x{what we selected} and also we are limiting the results to 1. If users table exist we will get true from this Query and Overall the AND should result in True which means we should see <span style="color:#ff0000;">Welcome back </span>message in response<br /><a href=""><img src="images/25-4.png" alt="images/25-4.png" /></a><br /><br /><br />now since we have confirmed that the users table does exist..<br /><br /><strong><span style="background-color:#7f7f7f;">• Checking if a user {administrator here} exists or not</span></strong><br /><br /><div class="codebox"><div class="codebox">&lt;cookie-already-here&gt;&nbsp;<span style="color:#3ad900;font-weight:400">&#39;&nbsp;AND&nbsp;(SELECT&nbsp;username&nbsp;FROM&nbsp;users&nbsp;WHERE&nbsp;username=&#39;</span>administrator<span style="color:#3ad900;font-weight:400">&#39;)=&#39;</span>administrator<span style="color:#3ad900;font-weight:400">&#39;--</span><br /></div></div><br /><br /><a href=""><img src="images/25-5.png" alt="images/25-5.png" /></a><br /><br />we get a welcome back which means that the condition overall went True and from this we can conclude that the administrator user does exist.<br /></div></body></html>